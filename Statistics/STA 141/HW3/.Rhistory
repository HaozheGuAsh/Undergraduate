}))
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname)
colnames(school) = c("lon","lat","schoolname")
graph = ggmap(ca)+geom_polygon(aes(x = long, y = lat,group=group), data = california, color = "blue",size=1,fill=NA)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5)+geom_text(data=school,aes(label=schoolname),size=5)
ca = get_map("California",zoom=6,maptype="satellite")
shape = readShapeSpatial("tl_2016_us_state")
states=fortify(shape)
california=subset(states,states$id=="13")
schoolname = sapply(1:nrow(rank),function(i){return(as.character(rank[i,1]))})
school = t(sapply(1:nrow(rank),function(i)
{
if(i!=8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),"CA"),output="latlon")
}
return (tmp)
}))
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname)
colnames(school) = c("lon","lat","schoolname")
graph = ggmap(ca)+geom_polygon(aes(x = long, y = lat,group=group), data = california, color = "blue",size=1,fill=NA)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5)+geom_text(data=school,aes(label=schoolname),size=5)
school
a=geocode("UC Berkeley",output="latlon")
geocode("UC Berkeley",output="latlon")
school = t(sapply(1:nrow(rank),function(i)
{
if(i!=8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),"CA"),output="latlon")
}
return (tmp)
}))
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname)
colnames(school) = c("lon","lat","schoolname")
school
school = sapply(1:nrow(rank),function(i)
{
if(i!=8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),"CA"),output="latlon")
}
return (tmp)
})
school
t(school)
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school
school = sapply(1:nrow(rank),function(i)
{
if(i!=8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),"CA"),output="latlon")
}
return (tmp)
})
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname)
colnames(school) = c("lon","lat","schoolname")
school
graph = ggmap(ca)+geom_polygon(aes(x = long, y = lat,group=group), data = california, color = "blue",size=1,fill=NA)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5)+geom_text(data=school,aes(label=schoolname),size=5)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=2,alpha=0.5)+geom_text(data=school,aes(label=schoolname),size=4)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=2,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=4)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=2,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5)
school
school = sapply(1:nrow(rank),function(i)
{
if(i!=8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),"CA"),output="latlon")
}
return (tmp)
})
school
geocode("UC Los Angeles",output="latlon")
geocode("UC Los Angeles,CA",output="latlon")
school = sapply(1:nrow(rank),function(i)
{
if(i==8)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school
school = sapply(1:nrow(rank),function(i)
{
if(i==10)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school
school = sapply(1:nrow(rank),function(i)
{
if(i==5)
{
tmp = geocode(as.character(rank[i,1]),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school
geocode("UC Davis",output="latlon")
geocode("UC Davis, CA",output="latlon")
geocode("UC Davis california",output="latlon")
geocode("UC Davis, USA",output="latlon")
school = sapply(1:nrow(rank),function(i)
{
if(i==5)
{
tmp = geocode(paste(as.character(rank[i,1]),",USA"),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname)
colnames(school) = c("lon","lat","schoolname")
graph = ggmap(ca)+geom_polygon(aes(x = long, y = lat,group=group), data = california, color = "blue",size=1,fill=NA)
school
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=2,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5)
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=2,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=4,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=10,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5,color="white")
city.loc$data
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=6,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=5,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=6,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=6,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=4,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=6,alpha=0.9)+geom_text(data=school,aes(label=schoolname),size=3.5,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
rank
rank[,2]
schoolstat = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,2:4]))})
schoolstat
schoolrank = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,2]))})
schoolrank
schoolname = sapply(1:nrow(rank),function(i){return(as.character(rank[i,1]))})
schoolrank = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,2]))})
schoolenroll = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,3]))})
schoolpercent = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,4]))})
colnames(school) = c("lon","lat","schoolname","Rank","Enrollment","Percentage")
california=subset(states,states$id=="13")
schoolname = sapply(1:nrow(rank),function(i){return(as.character(rank[i,1]))})
schoolrank = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,2]))})
schoolenroll = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,3]))})
schoolpercent = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,4]))})
school = sapply(1:nrow(rank),function(i)
{
if(i==5)
{
tmp = geocode(paste(as.character(rank[i,1]),",USA"),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname,schoolrank,schoolenroll,schoolpercent)
colnames(school) = c("lon","lat","schoolname","Rank","Enrollment","Percentage")
school
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Rank),color="white")
geocode("Reno,CA,USA",output="latlon")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Rank),size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage),alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Enrollment,color=Rank))
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,size=Rank),alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage),size=10,alpha=0.8)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Rank,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Rank,alpha=Percentage),size=10)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Rank,alpha=3*Percentage),size=10)+geom_text(data=school,aes(label=schoolname,size=Enrollment),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=3*Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-33*Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-3*Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-2*Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-*Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Percentage,alpha=Enrollment),size=10)+geom_text(data=school,aes(label=schoolname,size=-Rank),color="white")
graph+geom_point(data = school,aes(x=lon,y=lat,color=Enrollment,alpha=Percentage),size=10)+geom_text(data=school,aes(label=schoolname,size=-Rank),color="white")
graph2=graph+geom_point(data = school,aes(x=lon,y=lat,color=Enrollment,alpha=Percentage),size=10)+geom_text(data=school,aes(label=schoolname,size=-Rank),color="white")
graph2
geocode("Davis",output="all")
revgeocode(as.numeric(geocode("white house")))
from.loc= c("davis","davis","berkeley");to.loc= c("berkeley","san francisco","santacruz")
mapdist(from.loc, to.loc, mode = "driving") # or "walking" or "bicycling“
mapdist(from.loc, to.loc, mode = "driving") # or "walking" or "bicycling“
from.loc= c("davis, california"); to.loc= c("berkeley, california")
route_df= route(from.loc, to.loc, mode="driving", structure = "route") # returns a data frame containing route
View(route_df)
geocode("Davis",output="all")
revgeocode(as.numeric(geocode("white house")))
from.loc= c("davis","davis","berkeley");to.loc= c("berkeley","san francisco","santacruz")
mapdist(from.loc, to.loc, mode = "driving") # or "walking" or "bicycling“
from.loc= c("davis, california"); to.loc= c("berkeley, california")
route_df= route(from.loc, to.loc, mode="driving", structure = "route") # returns a data frame containing route
mapdist(from.loc, to.loc, mode = "driving") # or "walking" or "bicycling“
geocode("Davis",output="all")
revgeocode(as.numeric(geocode("white house")))
from.loc= c("davis","davis","berkeley");to.loc= c("berkeley","san francisco","santacruz")
mapdist(from.loc, to.loc, mode = "driving") # or "walking" or "bicycling“
a=(1,2,3)
a=c(1,2,3)
comb(a)
combn(a)
combn(a,2)
t(combn(a,2))
graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
schoolname
combn(schoolname,2)
a=combn(schoolname,2)
a
a[1]
a[1,1]
data.frame(matrix(unlist(a), nrow=2, byrow=T),stringsAsFactors=FALSE)
t(data.frame(matrix(unlist(a), nrow=2, byrow=T),stringsAsFactors=FALSE))
revgeocode(as.numeric(geocode("white house")))
revgeocode(as.numeric(geocode("UC Davis")))
revgeocode(as.numeric(geocode("UC Davis,CA")))
school
school[1,1:2]
revgeocode(school[1,1:2])
graph1
graph1=graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
graph1
graph1
from.loc= c("davis, california"); to.loc= c("berkeley, california")
route_df= route(from.loc, to.loc, mode="driving", structure = "route")
route_df
a = vector
a[1]=route_df
graph1+ geom_path(data = route_df, aes(x=lon, y=lat))
route_df
schoolname
from.loc= c("Los angeles, california"); to.loc= c("berkeley, california")
route2= route(from.loc, to.loc, mode="driving", structure = "route")
graph1+ geom_path(data = route1, aes(x=lon, y=lat))+geom_path(data = route2, aes(x=lon, y=lat))
route1= route(from.loc, to.loc, mode="driving", structure = "route")
graph1+ geom_path(data = route1, aes(x=lon, y=lat))+geom_path(data = route2, aes(x=lon, y=lat))
route1
route2
from.loc= c("davis, california"); to.loc= c("berkeley, california")
route1= route(from.loc, to.loc, mode="driving", structure = "route")
from.loc= c("Los angeles, california"); to.loc= c("berkeley, california")
route2= route(from.loc, to.loc, mode="driving", structure = "route")
route1
route()
route2
graph1+ geom_path(data = route1, aes(x=lon, y=lat))+geom_path(data = route2, aes(x=lon, y=lat))
graph1+ geom_path(data = route1, aes(x=lon, y=lat))+geom_path(data = route2, aes(x=lon, y=lat),size=3)
graph1+ geom_path(data = route1, aes(x=lon, y=lat),color="white")+geom_path(data = route2, aes(x=lon, y=lat),color = "white")
schoolname
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
city
nrow(city)
length(city)
all_comb = combn(city,2)
all_comb
all_comb = t(combn(city,2))
all_comb
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = combn(city,2)
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = combn(city,2)
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = t(data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE))
all_comb
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = t(combn(city,2))
all_comb
all_comb = data.frame(matrix(unlist(all_comb), nrow=36, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb[1]
all_comb[1,1]
all_comb$X1
colnames(all_comb) = c("from","to")
all_comb
graph1+ geom_path(data = route1, aes(x=lon, y=lat),color="white",size=2)+geom_path(data = route2, aes(x=lon, y=lat),color = "white")
graph1+ geom_path(data = route1, aes(x=lon, y=lat),color="white",size=1)+geom_path(data = route2, aes(x=lon, y=lat),color = "white")
graph1+ geom_path(data = route1, aes(x=lon, y=lat),color="white",size=1.5)+geom_path(data = route2, aes(x=lon, y=lat),color = "white")
all_comb
all_comb[1,]
all_comb[1,1]
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=36, byrow=T),stringsAsFactors=FALSE)
colnames(all_comb) = c("from","to")
graph3 = graph1
for(i in 1: length(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
length(comb)
length(all_comb)
nrow(all_comb)
graph3 = graph1
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
graph3
graph2
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=36, byrow=T),stringsAsFactors=FALSE)
colnames(all_comb) = c("from","to")
graph3 = graph2
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
graph3
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=36, byrow=T),stringsAsFactors=FALSE)
colnames(all_comb) = c("from","to")
graph3 = graph2
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
graph3
nrow(all_comb)
all_comb
all_comb = t(combn(city,2))
all_comb
all_comb = data.frame(matrix(unlist(all_comb), nrow=36, byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = data.frame(matrix(unlist(all_comb), nrow=2, byrow=T),stringsAsFactors=FALSE)
all_comb
t(all_comb)
all_comb = t(combn(city,2))
all_comb = data.frame(matrix(unlist(all_comb), nrow=nrow(all_comb), byrow=T),stringsAsFactors=FALSE)
all_comb
all_comb = t(combn(city,2))
all_comb = t(combn(city,2))
all_comb
unlist(all_comb)
all_comb[1]
all_comb[1,1]
all_comb[1,2]
colnames(all_comb) = c("from","to")
all_comb
all_comb[1,]
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = t(combn(city,2))
colnames(all_comb) = c("from","to")
all_comb
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
all_comb = t(combn(city,2))
colnames(all_comb) = c("from","to")
graph3 = graph2
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1.5)
}
graph3
all_comb
city = c("berkeley,california","Los angeles,california","santa barbara,california","irvine,california",
"davis.california","san diego,california","santa cruz,california","riverside,california","merced,california")
all_comb = t(combn(city,2))
colnames(all_comb) = c("from","to")
graph3 = graph2
for(i in 1: nrow(all_comb))
{
tmp = route(all_comb[i,1],all_comb[i,2],mode = "bicycling",structure = "route")
graph3 = graph3+ geom_path(data = tmp, aes(x=lon, y=lat),color="white",size=1)
}
graph3
from.loc= c("davis","davis","berkeley");to.loc= c("berkeley","san francisco","santacruz")
mapdist(from.loc, to.loc, mode = "driving")
mapdist(city,city, mode = "driving")
all_comb[1,]
all_comb[,1]
alldistance = mapdist(all_comb[,1],all_comb[,2], mode = "driving")
alldistance
library(igraph)
gr1 = graph()
gr1 = vertices(c("a","b"))
plot(gr1)
gr1 = vertices(c("a","b"))
gr1 = gr1 +edges(c(1,2))
gr1 = vertices(c("a","b"))
gr1 = gr1 +edges(c(1,2))
gr1 = graph.formula(1-2)
plot(gr1)
gr1 = graph.formula(1,2)
plot(gr1)
gr1 = gr1 +edges(c(1,2))
plot(gr1)
gr1 = graph.formula(schoolname)
plot(gr1)
gr1 = graph.formula()
plot(gr1)
sapply(1:length(schoolname),function(i){gr1=gr1+vertices(schoolname[i]); return()})
schoolname[1]
length(schoolname)
plot(gr1)
gr1=gr1+vertices(schoolname[i])
gr1
plot(gr1)
gr1=gr1+vertices("ddd")
plot(gr1)
gr1 = graph.formula()
sapply(1:length(schoolname),function(i){gr1=gr1+vertices(as.character(schoolname[i]));return()})
plot(gr1)
as.character(schoolname[1])
plot(gr1)
gr1=gr1+vertices(as.character(schoolname[1])
)
plot(gr1)
sapply(1:length(schoolname),function(i){gr1<<-gr1+vertices(as.character(schoolname[i]));return()})
sapply(1:length(schoolname),function(i){gr1<<-gr1+vertices(as.character(schoolname[i]))})
gr1 = graph.formula()
sapply(1:length(schoolname),function(i){gr1<<-gr1+vertices(as.character(schoolname[i]))})
plot(gr1)
plot(gr1)
plot(gr1)
ca = get_map("California",zoom=6,maptype="satellite")
shape = readShapeSpatial("tl_2016_us_state")
states=fortify(shape)
california=subset(states,states$id=="13")
schoolname = sapply(1:nrow(rank),function(i){return(as.character(rank[i,1]))})
schoolenroll = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,3]))})
schoolrank = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,2]))})
schoolpercent = sapply(1:nrow(rank),function(i){return(as.numeric(rank[i,4]))})
school = sapply(1:nrow(rank),function(i)
{
if(i==5)
{
tmp = geocode(paste(as.character(rank[i,1]),",USA"),output="latlon")
}
else
{
tmp = geocode(paste(as.character(rank[i,1]),",CA,USA"),output="latlon")
}
return (tmp)
})
school = data.frame(matrix(unlist(school), nrow=9, byrow=T),stringsAsFactors=FALSE)
school = cbind(school,schoolname,schoolrank,schoolenroll,schoolpercent)
colnames(school) = c("lon","lat","schoolname","Rank","Enrollment","Percentage")
graph = ggmap(ca)+geom_polygon(aes(x = long, y = lat,group=group), data = california, color = "blue",size=1,fill=NA)
graph1=graph+geom_point(data = school,aes(x=lon,y=lat),color="black",size=5,alpha=0.8)+geom_text(data=school,aes(label=schoolname),size=3,color="white")
graph1
plot(gr1)
